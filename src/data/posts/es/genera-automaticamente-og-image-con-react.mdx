---
title: 'Genera automaticamente tus og:image con React'
seotitle: 'Genera automaticamente tus og:image con React'
publishedAt: '2021-02-15'
summary: 'Una de las cosas m√°s tediosas al escribir posts no es escribirlo en si, es encontrar una imagen correcta para las redes sociales.'
image: '/static/images/genera-automaticamente-og-image-con-react/banner.jpg'
---

Una de las cosas m√°s tediosas al escribir posts no es escribirlo en si, es encontrar una imagen correcta para que cuando la compartamos en redes sociales llame la atenci√≥n y las personas quieran entrar a verla; inclusive usamos herramientas como Canva o PhotoShop para hacerlas, o llamamos a nuestro equipo de dise√±o y marketing para que creen esta imagen. **‚úã Ya no m√°s**

## ¬øY si te digo que puedes crear im√°genes con componentes de React?

Tengo ya un tiempo probando [Flayyer](https://flayyer.com/io) el cual es un _`og:image` as a service_, lo que nos promete este servicio es crear `templates` con React o Vue y usarlos para crear im√°genes en base a ellos, en estos `templates` podemos pasarle variables con los que podamos construir nuestras im√°genes, por ejemplo el `title` y el `backgroundImg` de un post y podemos obtener los siguientes resultados:

<a aria-label="Flayyer.io | Flayyer.com platform for better links" href="https://flayyer.com/io">
  <Image
    src="/static/images/genera-automaticamente-og-image-con-react/flayyer-twitter-card-preview.png"
    alt="Preview de image con dise√±o de Twitter"
    className="rounded-xl border border-white"
    width={466}
    height={346}
  />
</a>

Inclusive podemos detectar si el `userAgent` es WhatsApp y generar una imagen espec√≠fica para el:

<a aria-label="Flayyer.io | Flayyer.com platform for better links" href="https://flayyer.com/io">
  <Image
    src="/static/images/genera-automaticamente-og-image-con-react/flayyer-whatsapp-card-preview.png"
    alt="Preview de image con dise√±o de WhatsApp"
    className="rounded"
    width={480}
    height={152}
  />
</a>

En este caso como ejemplo es solo un cuadrado gris, pero podemos meter lo que sea all√≠; gracias a la manera en c√≥mo funciona [Flayyer](https://flayyer.com/io) podemos generar un view distinto dependiendo del `userAgent`, que actualmente son much√≠simos los que soporta:

```ts
declare enum FlayyerAgentName {
  FACEBOOK = 'facebook',
  MESSENGER = 'messenger',
  WHATSAPP = 'whatsapp',
  INSTAGRAM = 'instagram',
  LINKEDIN = 'linkedin',
  PINTEREST = 'pinterest',
  TELEGRAM = 'telegram',
  TWITTER = 'twitter',
  BING = 'bing',
  REDDIT = 'reddit',
  GOOGLE = 'google',
  GOOGLE_ADS = 'google ads',
  AMAZON_ALEXA = 'amazon alexa',
  AMAZON = 'amazon',
  YANDEX = 'yandex',
  YAHOO = 'yahoo',
  HUBSPOT = 'hubspot',
  MSN = 'msn',
  ZOOM = 'zoom',
  SLACK = 'slack',
  DISCORD = 'discord',
  SAFARI = 'safari',
  FLIPBOARD = 'flipboard',
  APPLE = 'apple',
  DUCKDUCKGO = 'duckduckgo',
  DISQUS = 'disqus',
}
```

Esto son los actuales pero poco a poco van agregando m√°s agents para que podamos personalizar a√∫n m√°s nuestras im√°genes

## ¬øC√≥mo empezar con Flayyer?

Primero que todo quiero comentarte que este tutorial ser√° para React, pero si quieres saber c√≥mo hacerlo con Vue d√©jamelo saber en mi [Twitter](https://twitter.com/danestves) con un DM.

Ahora iniciemos creando una app de Flayyer:

```bash
yarn create flayyer-app flayyer-tutorial
```

Se te presentar√°n algunas opciones para crear la aplicaci√≥n, para este tutorial seguiremos con la opci√≥n de `react-typescript-tailwind` (si a√∫n no sabes de TypeScript te recomiendo [este post](/blog/react-de-prop-types-a-typescript) donde ense√±o TS con React), luego de elegir esa opci√≥n le damos enter y esperamos a que se cree la carpeta con la aplicaci√≥n.

<AlertInfo title="Nota">
  Antes de que se termine necesitaremos una <b>FLAYYER_KEY</b> para poder hacer deploy de nuestra
  aplicaci√≥n dentro de Flayyer, para eso nos crearemos una cuenta en Flayyer y tomaremos la key de
  nuestra cuenta, puedes{' '}
  <a
    aria-label="Settings | Flayyer.com platform for better links"
    href="https://flayyer.com/dashboard/settings"
    className="text-blue-700 font-bold"
  >
    ingresar aqu√≠
  </a>{' '}
  . Guarda esta llave ya que la utilizaremos m√°s adelante.
</AlertInfo>

Cuando ya se haya terminado, entramos a la carpeta e instalamos las dependencias

```bash
cd flayyer-tutorial && yarn
```

Despu√©s de instalar las dependencias nos encontraremos con esta estructura de carpetas y archivos

```
flayyer-tutorial/
‚îú‚îÄ‚îÄ static/
‚îÇ   ‚îú‚îÄ‚îÄ background.jpg
‚îÇ   ‚îî‚îÄ‚îÄ logo.svg
‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îî‚îÄ‚îÄ hello.tsx
‚îú‚îÄ‚îÄ .eslintrc.js
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ flayyer.config.js
‚îú‚îÄ‚îÄ package.json
‚îú‚îÄ‚îÄ tsconfig.json
‚îú‚îÄ‚îÄ types.d.ts
‚îî‚îÄ‚îÄ README.md
```

Lo m√°s importante es lo que est√° dentro de la carpeta `templates`, ah√≠ tendremos nuestro primer archivo llamado `main.tsx`

```tsx:main.tsx
import React from "react"
import { TemplateProps } from "@flayyer/flayyer-types";
import classNames from "classnames";

import "../styles/tailwind.css";

import background from "../static/background.jpg";
import logo from "../static/logo.svg";

function Layer({ className, ...props}: React.ComponentPropsWithoutRef<"div">) {
  return <div {...props} className={classNames("absolute inset-0", className)} />;
}

// Make sure to 'export default' a React component
export default function MainTemplate({ variables }: TemplateProps) {
  const {
    title = "Hello world!",
    img = background,
    description,
  } = variables;

  return (
    <>
      <Layer>
        <img className="w-full h-full object-cover" src={img} />
      </Layer>
      <Layer className="bg-gradient-to-t from-gray-500 mt-64" />
      <Layer className="flex flex-col justify-end items-start px-12 py-12 text-white">
        <img src={logo} className={classNames("filter-white" /* custom */, "w-36 h-36")} />
        <h1 className="text-6xl mt-4">{title}</h1>
        {description && (
          <h2 className="text-4xl font-mono tracking-wider mt-2">{description}</h2>
        )}
      </Layer>
    </>
  );
}
```

Como puedes notar es un componente como cualquier otro de React, pero la diferencia es que podemos personalizarlo como nosotros queramos para crear una `og:image` √∫nica.

Recibe como par√°metros las `variables` que en este caso es lo que se manda a trav√©s de la URL y que usaremos para mandar cualquier tipo de dato y renderizarlo en el componente para que al final nos entregue una imagen.

En este caso la URL de una imagen se ver√≠a as√≠:

```
?title=Hello&20Word&img=my_image.jpg&description=here%20is%20my%20description
```

Puedes notar que se mandar en formato de URL Params, no tenemos que preocuparnos porque los caracteres se vean de una manera distinta, por ejemplo los espacios son transpilados a `%20` ya Flayyer se encarga de parsear estos datos y entregarnoslo de una manera limpia en el componente de React.

Ahora para ver nuestro componente iniciamos el servidor de desarrollo con

```bash
yarn start
```

<Image
  src="/static/images/genera-automaticamente-og-image-con-react/yarn-start.png"
  alt="Inicio de servidor de desarrollo con la terminal"
  width={607}
  height={342}
/>

Para ver nuestro componente ingresamos a <a aria-label="Flayyer Studio" href="https://flayyer.github.io/flayyer-studio/">Flayyer Studio</a> y tendremos la siguiente pantalla

<Image
  src="/static/images/genera-automaticamente-og-image-con-react/flayyer-studio.png"
  alt="Flayyer Studio"
  width={1156}
  height={1001}
/>

Ahora esta grandiosa pantalla es donde tendremos refrescado autom√°tico cada vez que cambiamos algo en el componente y en donde le podemos pasar variables para ver c√≥mo act√∫a nuestro componente:

| Campo      | Descripci√≥n                                                                                                                                                         |
| ---------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Base URL   | La URL de nuestro servidor local, por default `http://localhost:7777`                                                                                               |
| Templates  | El nombre del template que queremos ver, estos nombres ser√° el nombre del archivo dentro de la carpeta `templates`                                                  |
| User agent | Podemos emular el agente desde donde queremos ver la imagen, por ahora tiene `default` que es el navegador y WhatsApp, pero poco a poco ir√°n agregando m√°s          |
| Variables  | Y aqu√≠ se puede decir que es donde sucede la magia, es donde pasaremos todas las variables en formato JSON y jugaremos con ellas para ver c√≥mo act√∫a nuestra imagen |

<Image
  src="/static/images/genera-automaticamente-og-image-con-react/flayyer-studio-play.png"
  alt="Flayyer Studio"
  width={1156}
  height={1001}
/>

Ahora vamos a crear un custom component para cuando sea la vista de WhatsApp

```tsx:main.tsx
import React from "react"
// A√±ade FlayyerAgentName para traer el enum que usaremos m√°s abajo
import { TemplateProps, FlayyerAgentName } from "@flayyer/flayyer-types";
import classNames from "classnames";

import "../styles/tailwind.css";

import background from "../static/background.jpg";
import logo from "../static/logo.svg";

function Layer({ className, ...props}: React.ComponentPropsWithoutRef<"div">) {
  return <div {...props} className={classNames("absolute inset-0", className)} />;
}

// A√±ade agent para poder usar esta prop tambi√©n
export default function MainTemplate({ agent, variables }: TemplateProps) {
  const {
    title = "Hello world!",
    img = background,
    description,
  } = variables;

  // Y ahora a√±adimos este condicional para detectar su el userAgent es WhatsApp
  if (agent.name === FlayyerAgentName.WHATSAPP) {
    return (
      <Layer className="p-20 bg-white">
        <img
          src={logo}
          alt={title}
          className="w-full h-full"
        />
      </Layer>
    );
  }

  return (
    <>
      <Layer>
        <img className="w-full h-full object-cover" src={img} />
      </Layer>
      <Layer className="bg-gradient-to-t from-gray-500 mt-64" />
      <Layer className="flex flex-col justify-end items-start px-12 py-12 text-white">
        <img src={logo} className={classNames("filter-white" /* custom */, "w-36 h-36")} />
        <h1 className="text-6xl mt-4">{title}</h1>
        {description && (
          <h2 className="text-4xl font-mono tracking-wider mt-2">{description}</h2>
        )}
      </Layer>
    </>
  );
}
```

Con eso, ahora nos vamos a nuestro navegador y cambiamos el `User agent` a WhatsApp

<Image
  src="/static/images/genera-automaticamente-og-image-con-react/flayyer-studio-whatsapp-agent.png"
  alt="Flayyer Studio con Whatsapp como agent"
  width={1156}
  height={1001}
/>

Veremos que ahora tenemos nuestra vista de c√≥mo se ver√≠a la imagen en WhatsApp, y as√≠ podemos personalizar como nosotros queramos la vista en WhatsApp y la vista normal. Recuerda que no √∫nicamente tenemos solo WhatsApp, tenemos toda una lista de agents que podemos utilizar para personalizar las im√°genes.

Ahora, de aqu√≠ en adelante te toca darle tu toque personal, cambiar colores, crear nuevo c√≥digo y personalizarlo a tu manera. Por motivos del post de mi parte yo lo dejar√© as√≠ de simple para que podamos continuar con la explicaci√≥n.

## Deploy de nuestro componente

Bien, despu√©s de que ya hayamos personalizado nuestro componente ha llegado la hora de hacer deploy de nuestra app, y esto es muy sencillo. ¬øRecuerdas `FLAYYER_KEY` que te coment√© m√°s arriba usar√≠amos m√°s adelante? Bueno, ahora mismo la vamos a utilizar; lo primero que haremos es pausar la ejecuci√≥n del servidor de desarrollo de Flayyer y ejecutamos los siguientes comandos en la terminal:

```bash
# Recuerda reemplazar el texto despu√©s del = con tu llave
export FLAYYER_KEY=wdswermdcl8346egcsre
```

```bash
yarn build && yarn deploy
```

Despu√©s de que se haya terminado, nuestro template estar√° arriba en Flayyer para que pueda ser usado, podr√°s ver las propiedades de tu deploy dentro de tu cuenta en Flayyer que previamente creamos.

## ¬øC√≥mo podemos usar nuestro componente?

Quiero darle mucha m√°s visibilidad a la documentaci√≥n as√≠ que te dejar√© enlaces directos a c√≥mo usar Flayyer con tu tecnolog√≠a favorita, la documentaci√≥n est√° muy bien escrita y adem√°s, ya pasaste la parte m√°s _complicada_ que es la creaci√≥n de tu componente de `og:image`:

- [Next.js](https://docs.flayyer.com/guides/javascript/nextjs)
- [Gatsby.js](https://docs.flayyer.com/guides/javascript/gatsbyjs)
- [Express](https://docs.flayyer.com/guides/javascript/expressjs)
- [Docusaurus.io](https://docs.flayyer.com/guides/javascript/docusaurus)
- [Python](https://docs.flayyer.com/guides/python/flayyer)
- [Django](https://docs.flayyer.com/guides/python/django)
- [Ruby](https://docs.flayyer.com/guides/ruby/flayyer)
- [Ruby on Rails](https://docs.flayyer.com/guides/ruby/rails)
- [PHP](https://docs.flayyer.com/guides/php/flayyer)
- [WordPress](https://docs.flayyer.com/guides/php/wordpress)

## ¬øQuieres ver un ejemplo corriendo?

Inspecciona esta p√°gina con la consola del navegador y luego te vas al `<head>`, busca un tag llamado `og:image` y te dar√°s cuenta c√≥mo funciona ya arriba en producci√≥n, incluso puedes entrar a la URL de la imagen para que puedas verla tu mismo.

En todo mi sitio web yo utilizo NextJS, si quieres ver c√≥mo yo lo implemento te dejo un estracto de c√≥digo y el enlace directo al archivo:

```tsx:src/layouts/blog.tsx
const flayyer = new Flayyer({
  tenant: 'danestves',
  deck: 'danestves',
  template: 'blog',
  variables: {
    img: `https://danestves.com${frontMatter.image}`,
    title: frontMatter.seotitle,
    description: frontMatter.summary,
  },
  meta: {
    id: frontMatter.slug,
  },
})
```

[Ver archivo](https://github.com/danestves/website/blob/master/src/layouts/blog.tsx#L40)

## Conclusiones

Como puedes ver cada vez salen m√°s y m√°s herramientas que nos hacen el desarrollo much√≠simo m√°s f√°cil cada d√≠a, ahora solo llamamos a una librer√≠a y ya hace todo el trabajo por nosotros. **Tercerizar** los servicios es para mi una de las mejores cosas de la programaci√≥n, espero que este post haya sido de mucha ayuda y si quieres que haga un post sobre c√≥mo realizar las `og:image` con Vue d√©jamelo saber en un comentario en Twitter y as√≠ sabr√© cuantas personas est√°n interesadas por el siguiente post üöÄ

**- Los veo en el c√≥digo üë®‚Äçüíª**
